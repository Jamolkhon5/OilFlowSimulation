{% extends "base.html" %}

{% block title %}Справка - Моделирование фильтрации нефти{% endblock %}

{% block content %}
<div class="row mb-4">
    <div class="col-md-8">
        <h1>Справка и инструкции</h1>
        <p class="lead">Руководство по использованию системы моделирования фильтрации нефти.</p>
    </div>
</div>

<div class="help-section">
    <h2>Содержание</h2>
    <ul>
        <li><a href="#introduction">Введение</a></li>
        <li><a href="#models">Доступные модели</a></li>
        <li><a href="#parameters">Параметры моделирования</a></li>
        <li><a href="#file-formats">Форматы файлов данных</a></li>
        <li><a href="#visualization">Визуализация результатов</a></li>
        <li><a href="#interpretation">Интерпретация результатов</a></li>
        <li><a href="#faq">Часто задаваемые вопросы</a></li>
    </ul>
</div>

<div id="introduction" class="help-section">
    <h2>Введение</h2>
    <p>Система моделирования одномерной фильтрации нефти в пористой среде с учетом капиллярных эффектов предназначена для инженеров и исследователей в нефтегазовой отрасли. Она позволяет проводить численное моделирование процесса фильтрации нефти с использованием метода апвинд, который обеспечивает стабильное решение даже при наличии разрывов в решении.</p>

    <h3>Основные возможности системы:</h3>
    <ul>
        <li>Моделирование одномерной фильтрации нефти в пористой среде</li>
        <li>Учет капиллярных эффектов</li>
        <li>Специализированная модель для карбонатных коллекторов с учетом двойной пористости</li>
        <li>Импорт реальных данных о свойствах породы, капиллярном давлении и относительной проницаемости</li>
        <li>Наглядная визуализация результатов моделирования</li>
        <li>Возможность сравнения результатов с учетом и без учета капиллярных эффектов</li>
    </ul>
</div>

<div id="models" class="help-section">
    <h2>Доступные модели</h2>

    <h3>Базовая модель</h3>
    <p>Базовая модель описывает одномерную фильтрацию нефти в пористой среде с учетом капиллярных эффектов. Она основана на следующих принципах:</p>
    <ul>
        <li>Закон Дарси для описания скорости фильтрации</li>
        <li>Уравнение неразрывности для сохранения массы</li>
        <li>Функция Баклея-Леверетта для описания двухфазного течения</li>
        <li>Модель Брукса-Кори для капиллярного давления</li>
    </ul>

    <p>Математическая модель представлена уравнением:</p>
    <pre><code>
    ∂S/∂t + ∂f(S)/∂x = ∂/∂x(D(S)∂S/∂x)
    </code></pre>

    <p>где:</p>
    <ul>
        <li>S - водонасыщенность</li>
        <li>f(S) - функция Баклея-Леверетта (доля потока воды)</li>
        <li>D(S) - функция капиллярной диффузии</li>
        <li>t - время</li>
        <li>x - пространственная координата</li>
    </ul>

    <h3>Модель для карбонатных коллекторов</h3>
    <p>Расширенная модель для карбонатных коллекторов учитывает особенности фильтрации в среде с двойной пористостью (матрица и трещины). Основные дополнения к базовой модели:</p>
    <ul>
        <li>Разделение пористости на пористость матрицы и пористость трещин</li>
        <li>Различие в проницаемости матрицы и трещин</li>
        <li>Учет обмена флюидами между матрицей и трещинами</li>
        <li>Учет капиллярных эффектов в матрице</li>
    </ul>

    <p>Это позволяет более точно моделировать фильтрацию в карбонатных коллекторах, где наличие трещин существенно влияет на динамику процесса.</p>
</div>

<div id="parameters" class="help-section">
    <h2>Параметры моделирования</h2>

    <h3>Параметры пласта</h3>
    <ul>
        <li><strong>Длина пласта</strong> (м) - протяженность моделируемого участка пласта.</li>
        <li><strong>Пористость</strong> (д.ед.) - доля объема породы, занятая порами.</li>
        <li><strong>Пористость трещин</strong> (д.ед.) - доля объема породы, занятая трещинами (только для карбонатной модели).</li>
        <li><strong>Проницаемость матрицы</strong> (мД) - проницаемость матрицы породы (только для карбонатной модели).</li>
        <li><strong>Проницаемость трещин</strong> (мД) - проницаемость трещин (только для карбонатной модели).</li>
        <li><strong>Форм-фактор</strong> (отн.ед.) - характеризует интенсивность обмена флюидами между матрицей и трещинами (только для карбонатной модели).</li>
    </ul>

    <h3>Параметры флюидов</h3>
    <ul>
        <li><strong>Вязкость нефти</strong> (мПа·с) - динамическая вязкость нефти.</li>
        <li><strong>Вязкость воды</strong> (мПа·с) - динамическая вязкость воды.</li>
        <li><strong>Начальная водонасыщенность</strong> (д.ед.) - доля порового пространства, изначально занятая водой.</li>
        <li><strong>Остаточная нефтенасыщенность</strong> (д.ед.) - минимальная доля порового пространства, занятая нефтью, которая не может быть вытеснена.</li>
    </ul>

    <h3>Капиллярные параметры</h3>
    <ul>
        <li><strong>Давление входа</strong> (МПа) - капиллярное давление, необходимое для начала вытеснения несмачивающей фазы.</li>
        <li><strong>Индекс распределения пор</strong> (отн.ед.) - характеризует распределение пор по размерам (параметр модели Брукса-Кори).</li>
        <li><strong>Коэффициент смачиваемости</strong> (отн.ед.) - характеризует смачиваемость породы (1 - гидрофильная, 0 - гидрофобная).</li>
    </ul>

    <div class="alert alert-info">
        <p><strong>Примечание:</strong> Все параметры модели должны находиться в допустимых пределах, указанных в интерфейсе. При выходе за эти пределы система выдаст предупреждение.</p>
    </div>
</div>

<div id="file-formats" class="help-section">
    <h2>Форматы файлов данных</h2>
    <p>Система поддерживает импорт данных из файлов CSV и Excel (.xlsx, .xls). Ниже приведены требования к форматам файлов:</p>

    <h3>Общие требования:</h3>
    <ul>
        <li>Файлы CSV должны использовать запятую или точку с запятой в качестве разделителя</li>
        <li>Первая строка файла должна содержать названия колонок</li>
        <li>Десятичный разделитель - точка</li>
    </ul>

    <h3>Требования к колонкам файлов:</h3>
    <div class="table-responsive">
        <table class="table table-bordered file-format-table">
            <thead>
                <tr>
                    <th>Тип файла</th>
                    <th>Обязательные колонки</th>
                    <th>Примечания</th>
                </tr>
            </thead>
            <tbody>
                <tr>
                    <td>Свойства породы</td>
                    <td>ID_Sample, Porosity_fr, Permeability_mD, Rock_Type</td>
                    <td>
                        <ul>
                            <li>Porosity_fr - пористость в долях единицы (0-1)</li>
                            <li>Permeability_mD - проницаемость в миллидарси</li>
                            <li>Rock_Type - тип породы (текстовое значение)</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>Капиллярное давление</td>
                    <td>ID_Sample, Water_Saturation, Pc_Drainage_MPa</td>
                    <td>
                        <ul>
                            <li>Water_Saturation - водонасыщенность в долях единицы (0-1)</li>
                            <li>Pc_Drainage_MPa - капиллярное давление при дренировании в МПа</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>Относительная проницаемость</td>
                    <td>ID_Sample, Water_Saturation, Krw_Drainage, Kro_Drainage</td>
                    <td>
                        <ul>
                            <li>Water_Saturation - водонасыщенность в долях единицы (0-1)</li>
                            <li>Krw_Drainage - относительная проницаемость воды при дренировании</li>
                            <li>Kro_Drainage - относительная проницаемость нефти при дренировании</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>PVT-данные</td>
                    <td>Pressure_MPa, Oil_Viscosity_cP</td>
                    <td>
                        <ul>
                            <li>Pressure_MPa - давление в МПа</li>
                            <li>Oil_Viscosity_cP - вязкость нефти в сантипуазах</li>
                            <li>Дополнительно: Oil_Density_kg_m3, Gas_Density_kg_m3 и др.</li>
                        </ul>
                    </td>
                </tr>
                <tr>
                    <td>Данные добычи</td>
                    <td>Date, Oil_Rate_m3_day, Water_Rate_m3_day</td>
                    <td>
                        <ul>
                            <li>Date - дата в формате YYYY-MM-DD</li>
                            <li>Oil_Rate_m3_day - дебит нефти в м³/сут</li>
                            <li>Water_Rate_m3_day - дебит воды в м³/сут</li>
                        </ul>
                    </td>
                </tr>
            </tbody>
        </table>
    </div>

    <h3>Пример содержимого файла свойств породы (CSV):</h3>
    <pre><code>
ID_Sample,Porosity_fr,Permeability_mD,Rock_Type,Wettability_Index
Sample1,0.18,10.5,Песчаник,0.7
Sample2,0.15,5.2,Известняк,0.5
Sample3,0.12,2.1,Доломит,0.4
Sample4,0.20,15.8,Песчаник,0.65
    </code></pre>

    <h3>Пример содержимого файла капиллярного давления (CSV):</h3>
    <pre><code>
ID_Sample,Water_Saturation,Pc_Drainage_MPa,Pc_Imbibition_MPa
Sample1,0.20,3.5,1.2
Sample1,0.25,2.8,1.0
Sample1,0.30,2.2,0.8
Sample1,0.40,1.5,0.5
Sample1,0.50,1.0,0.3
Sample1,0.60,0.6,0.2
Sample1,0.70,0.3,0.1
Sample1,0.80,0.1,0.0
    </code></pre>
</div>

<div id="visualization" class="help-section">
    <h2>Визуализация результатов</h2>
    <p>Система предоставляет различные типы визуализации результатов моделирования:</p>

    <h3>Профили насыщенности</h3>
    <p>Графики распределения насыщенности воды по длине пласта для разных моментов времени. Позволяют наблюдать продвижение фронта вытеснения и оценивать влияние капиллярных эффектов на его форму.</p>

    <h3>Коэффициент нефтеотдачи</h3>
    <p>График зависимости коэффициента нефтеотдачи от времени. Позволяет оценить эффективность вытеснения нефти и влияние капиллярных эффектов на нефтеотдачу.</p>

    <h3>Эволюция насыщенности</h3>
    <p>Контурный график изменения насыщенности во времени и пространстве. Позволяет наглядно представить динамику процесса фильтрации.</p>

    <h3>Разница насыщенности</h3>
    <p>График разницы между насыщенностями, полученными с учетом и без учета капиллярных эффектов. Позволяет точно определить области, где влияние капиллярных эффектов наиболее существенно.</p>

    <h3>Кривые капиллярного давления и относительной проницаемости</h3>
    <p>Графики зависимостей капиллярного давления и относительных проницаемостей от насыщенности. Позволяют анализировать свойства породы и флюидов.</p>

    <div class="alert alert-info">
        <p><strong>Совет:</strong> Для детального анализа наведите курсор на график, чтобы увидеть точные значения. Для масштабирования используйте инструменты, доступные в правом верхнем углу графика.</p>
    </div>
</div>

<div id="interpretation" class="help-section">
    <h2>Интерпретация результатов</h2>

    <h3>Влияние капиллярных эффектов на профиль насыщенности</h3>
    <p>Капиллярные эффекты приводят к сглаживанию фронта вытеснения нефти водой. Без учета капиллярных эффектов фронт имеет резкую границу, в то время как с учетом капиллярных эффектов наблюдается более плавный переход от высокой к низкой водонасыщенности.</p>

    <h3>Влияние капиллярных эффектов на время прорыва воды</h3>
    <p>Капиллярные эффекты могут как ускорять, так и замедлять продвижение фронта вытеснения и, соответственно, изменять время прорыва воды. Это зависит от конкретных параметров пласта и флюидов.</p>

    <h3>Влияние капиллярных эффектов на коэффициент нефтеотдачи</h3>
    <p>Капиллярные эффекты могут увеличивать коэффициент нефтеотдачи за счет более равномерного вытеснения нефти и уменьшения объема защемленной нефти. Однако в некоторых случаях они могут приводить к образованию застойных зон и снижению эффективности вытеснения.</p>

    <h3>Особенности карбонатных коллекторов</h3>
    <p>В карбонатных коллекторах с двойной пористостью наблюдается сложное взаимодействие между течением в трещинах и матрице. Капиллярные эффекты играют важную роль в обмене флюидами между матрицей и трещинами.</p>

    <div class="alert alert-warning">
        <p><strong>Внимание:</strong> Интерпретация результатов должна учитывать ограничения одномерной модели. В реальных пластах процессы фильтрации могут быть более сложными и требовать двумерного или трехмерного моделирования.</p>
    </div>
</div>

<div id="faq" class="help-section">
    <h2>Часто задаваемые вопросы</h2>

    <h3>Какие типы пород можно моделировать?</h3>
    <p>Система позволяет моделировать фильтрацию в различных типах пород, включая песчаники, известняки и доломиты. Для карбонатных коллекторов (известняки, доломиты) доступна специализированная модель с учетом двойной пористости.</p>

    <h3>Необходимо ли загружать все файлы данных?</h3>
    <p>Нет, загрузка файлов данных является опциональной. Если файлы не загружены, система будет использовать параметры, заданные пользователем. Загрузка файлов позволяет использовать реальные данные для более точного моделирования.</p>

    <h3>Какие граничные условия используются в модели?</h3>
    <p>На входе в пласт задается постоянная водонасыщенность (0.8), а на выходе из пласта ставится условие отсутствия капиллярных эффектов (∂S/∂x = 0).</p>

    <h3>Как долго выполняется моделирование?</h3>
    <p>Время выполнения моделирования зависит от параметров модели и количества узлов сетки. Обычно оно составляет от нескольких секунд до нескольких минут. Более сложные расчеты с карбонатной моделью могут занимать больше времени.</p>

    <h3>Можно ли сравнить результаты с и без учета капиллярных эффектов?</h3>
    <p>Да, система автоматически проводит расчеты для обоих случаев и предоставляет инструменты для сравнения результатов. Это позволяет оценить влияние капиллярных эффектов на процесс фильтрации.</p>

    <h3>Каким методом решается уравнение фильтрации?</h3>
    <p>Уравнение фильтрации решается методом апвинд (upwind), который обеспечивает стабильное решение даже при наличии разрывов в решении.</p>

    <h3>Можно ли использовать результаты моделирования для реальных проектов?</h3>
    <p>Результаты моделирования могут быть использованы для качественного анализа влияния капиллярных эффектов и предварительной оценки параметров фильтрации. Однако для принятия важных инженерных решений рекомендуется использовать более сложные многомерные модели и проводить калибровку на реальных данных.</p>
</div>
{% endblock %}